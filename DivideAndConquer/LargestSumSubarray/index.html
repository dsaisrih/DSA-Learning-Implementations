<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Max Subarray Tree (Detailed)</title>

<style>
:root{
    --bg1: #0f2027;
    --bg2: #203a43;
    --bg3: #2c5364;
    --card: rgba(255,255,255,0.06);
    --accent: #8be9fd;
    --accent-2: #7effa6;
}
html,body{height:100%;}
body {
    font-family: Inter, system-ui, -apple-system, Arial, sans-serif;
    margin:0;
    min-height:100%;
    background: radial-gradient(ellipse at 10% 10%, rgba(255,255,255,0.03), transparent 10%), linear-gradient(135deg,var(--bg1),var(--bg3));
    color: #e6f0f2;
    -webkit-font-smoothing:antialiased;
}

.wrap{
    max-width:1100px;
    margin:40px auto;
    padding:28px;
    text-align:center;
    backdrop-filter: blur(6px) saturate(1.05);
}

h2{
    margin:0 0 18px 0;
    font-weight:600;
    letter-spacing:0.3px;
    color: #fff;
    position:relative;
}

h2::after{
    content:'';
    width:80px;
    height:4px;
    display:block;
    margin:10px auto 0;
    background:linear-gradient(90deg,var(--accent),var(--accent-2));
    border-radius:4px;
    transform-origin:left center;
    animation:grow 800ms ease both;
}

@keyframes grow{from{transform:scaleX(0)} to{transform:scaleX(1)}}

input{
    padding:12px 14px;
    width:480px;
    max-width:90%;
    margin:16px 8px;
    border-radius:10px;
    border:1px solid rgba(255,255,255,0.08);
    background: rgba(255,255,255,0.03);
    color: #e6f0f2;
    outline:none;
    transition:box-shadow .18s ease, transform .12s ease;
}

input:focus{ box-shadow: 0 6px 18px rgba(0,0,0,0.35), 0 0 0 6px rgba(139,233,253,0.06); transform: translateY(-2px); }

button{
    padding:12px 18px;
    background: linear-gradient(90deg,var(--accent),#5ef3c1);
    color:#023232;
    border:none;
    border-radius:10px;
    cursor:pointer;
    font-weight:600;
    box-shadow: 0 8px 24px rgba(2,50,50,0.25);
    transition: transform .12s ease, box-shadow .12s ease;
}

button:hover{ transform:translateY(-3px); box-shadow: 0 12px 30px rgba(2,50,50,0.32); }

.tree {
    margin-top:26px;
    perspective:800px;
}

/* root and generic list layout */
.tree ul{
    padding-top:20px;
    position:relative;
    display:flex;
    justify-content:center;
    align-items:flex-start;
    gap:32px;
}

/* each node stacks its children vertically */
.tree li {
    list-style:none;
    text-align:center;
    position:relative;
    padding:32px 8px 0 8px;
    display:flex;
    flex-direction:column;
    align-items:center;
    opacity:0;
    transform:translateY(8px) scale(.995);
    animation:pop .42s cubic-bezier(.2,.9,.2,1) forwards;
}

/* connector from this node down to its children */
.tree li > ul {
    margin-top:18px;
    padding-top:18px;
    position:relative;
    display:flex;
    justify-content:center;
    gap:28px;
}
/* horizontal connector line between siblings */
.tree li > ul::after {
    content:'';
    position:absolute;
    top:0;
    left:0;
    width:100%;
    height:2px;
    background:#ffb300;
    box-shadow:0 0 6px 2px #ffb30099;
    border-radius:2px;
}

/* horizontal connector line between child nodes */
.tree li > ul > li::before{
    content:'';
    position:absolute;
    top:0;
    left:50%;
    transform:translateX(-50%);
    width:2px;
    height:18px;
    background:transparent;
}

/* draw small slanted connectors from parent to child boxes */
.tree li > ul > li::after{
    content:'';
    position:absolute;
    top:-32px;
    left:50%;
    transform:translateX(-50%);
    width:0;
    height:32px;
    border-left:4px solid #ffb300;
    box-shadow:0 0 6px 2px #ffb30099;
    opacity:1;
    border-radius:2px;
}

/* if only child, hide connectors */
.tree li:only-child > ul::before,
.tree li:only-child > ul > li::after{ display:none; }

.node{
    border-radius:12px;
    padding:12px 16px;
    min-width:220px;
    background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
    border:1px solid rgba(255,255,255,0.06);
    box-shadow: 0 6px 18px rgba(2,18,23,0.45);
    color:#eaf7f7;
    display:inline-block;
    transition: transform .18s ease, box-shadow .18s ease, background .18s ease;
}

.node:hover{ transform:translateY(-6px) scale(1.01); box-shadow:0 20px 40px rgba(2,18,23,0.6); }

.max-path{
    background: linear-gradient(90deg, rgba(255,230,150,0.14), rgba(255,200,120,0.08));
    border:1px solid rgba(255,200,80,0.22);
}

.node.selected{ animation: pulse 1200ms ease-in-out infinite; }

.result{ color: var(--accent-2); font-weight:700; }

@keyframes pop{ from{opacity:0; transform:translateY(8px) scale(.98)} to{opacity:1; transform:none} }

@keyframes pulse{ 0%{ box-shadow:0 0 0 0 rgba(255,200,80,0.18)} 70%{ box-shadow:0 0 0 18px rgba(255,200,80,0)} 100%{ box-shadow:0 0 0 0 rgba(255,200,80,0)} }

@media (max-width:720px){ .node{min-width:160px} input{width:92%} }

</style>
</head>
<body>

<div class="wrap">
<h2>Largest Sum Subarray (Divide & Conquer Detailed Tree)</h2>

<input type="text" id="arrayInput" placeholder="Example: -6,-2,8,3,4,-2">
<button onclick="start()">Generate Tree</button>

<div class="tree" id="output"></div>
</div>

<script>

function maxCrossing(arr, left, mid, right) {

    let sum = 0, leftSum = -Infinity, maxLeft = mid;

    for (let i = mid; i >= left; i--) {
        sum += arr[i];
        if (sum > leftSum) {
            leftSum = sum;
            maxLeft = i;
        }
    }

    sum = 0;
    let rightSum = -Infinity, maxRight = mid + 1;

    for (let i = mid + 1; i <= right; i++) {
        sum += arr[i];
        if (sum > rightSum) {
            rightSum = sum;
            maxRight = i;
        }
    }

    return {
        sum: leftSum + rightSum,
        start: maxLeft,
        end: maxRight
    };
}

function buildTree(arr, left, right) {

    if (left === right) {
        return {
            sum: arr[left],
            start: left,
            end: right,
            html: `<li>
                <div class="node">
                    Subarray: [${arr[left]}]<br>
                    Max = ${arr[left]}
                </div>
            </li>`
        };
    }

    let mid = Math.floor((left + right) / 2);

    let leftTree = buildTree(arr, left, mid);
    let rightTree = buildTree(arr, mid + 1, right);
    let cross = maxCrossing(arr, left, mid, right);

    let maxVal = Math.max(leftTree.sum, rightTree.sum, cross.sum);

    let chosenStart, chosenEnd, chosenType;

    if (maxVal === leftTree.sum) {
        chosenStart = leftTree.start;
        chosenEnd = leftTree.end;
        chosenType = "LEFT";
    } else if (maxVal === rightTree.sum) {
        chosenStart = rightTree.start;
        chosenEnd = rightTree.end;
        chosenType = "RIGHT";
    } else {
        chosenStart = cross.start;
        chosenEnd = cross.end;
        chosenType = "CROSS";
    }

    let chosenSubarray = arr.slice(chosenStart, chosenEnd + 1);

    let html = `
    <li>
        <div class="node max-path">
            <span style="font-weight:700;color:#ffb300">Current Array:</span> <span style="color:#fff">[${arr.slice(left, right+1)}]</span><br><br>

            <span style="color:#7effa6;font-weight:600">Left Subarray:</span> <span style="color:#fff">[${arr.slice(leftTree.start, leftTree.end+1)}]</span>
            <span style="color:#8be9fd">â†’ Sum = ${leftTree.sum}</span><br>

            <span style="color:#7effa6;font-weight:600">Right Subarray:</span> <span style="color:#fff">[${arr.slice(rightTree.start, rightTree.end+1)}]</span>
            <span style="color:#8be9fd">â†’ Sum = ${rightTree.sum}</span><br>

            <span style="color:#ffeaa7;font-weight:600">Crossing Subarray:</span> <span style="color:#fff">[${arr.slice(cross.start, cross.end+1)}]</span>
            <span style="color:#ffb300">â†’ Sum = ${cross.sum}</span><br><br>

            <span class="result">
            Selected <span style="color:#ffb300">(${chosenType})</span> = <span style="color:#fff">[${chosenSubarray}]</span> â†’ <span style="color:#ffb300">${maxVal}</span>
            </span>
        </div>

        <ul>
            ${leftTree.html}
            ${rightTree.html}
        </ul>
    </li>`;

    return {
        sum: maxVal,
        start: chosenStart,
        end: chosenEnd,
        html: html
    };
}


function start() {

    let input = document.getElementById("arrayInput").value;
    let arr = input.split(",").map(s => Number(s.trim())).filter(n => !Number.isNaN(n));

    if (arr.length === 0) return;

    let result = buildTree(arr, 0, arr.length - 1);

    document.getElementById("output").innerHTML =
        `<ul>${result.html}</ul>
         <h3 class="final">ðŸŒŸ Final Maximum Subarray = [${arr.slice(result.start, result.end+1)}]
         â†’ Sum = ${result.sum}</h3>`;

    // trigger animations and highlight
    animateTree();
}

function animateTree(){
    // stagger node entrance
    const lis = document.querySelectorAll('.tree li');
    lis.forEach((el,i)=> el.style.animationDelay = (i*60)+'ms');

    // allow browser to paint then add selected pulse
    requestAnimationFrame(()=>{
        const chosen = document.querySelector('.node.max-path');
        if(chosen) chosen.classList.add('selected');
        const final = document.querySelector('.final');
        if(final) final.style.animation = 'fadeIn .6s ease .25s forwards';
    });
}

// small helper animation keyframes added dynamically in JS to keep CSS edits minimal
const styleSheet = document.createElement('style');
styleSheet.innerHTML = `@keyframes fadeIn{from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:none}}`;
document.head.appendChild(styleSheet);


</script>

</body>
</html>
